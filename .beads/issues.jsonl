{"id":"homeassistant_adguard_home-0d8","title":"AdGuard Home Extended HACS Integration","description":"Build a comprehensive HACS integration for AdGuard Home with extended features beyond the core integration","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T15:52:08.727652-05:00","updated_at":"2025-12-17T16:26:27.861995-05:00","closed_at":"2025-12-17T16:26:27.861995-05:00"}
{"id":"homeassistant_adguard_home-1bb","title":"Project scaffolding and structure","description":"Create base project structure: custom_components/adguard_home_extended/, manifest.json, const.py, __init__.py","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T15:52:14.287541-05:00","updated_at":"2025-12-17T15:59:33.948677-05:00","closed_at":"2025-12-17T15:59:33.948677-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-1bb","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.604377-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-1zv","title":"Remove duplicate device_info property in coordinator","description":"## Problem\nThe \\`AdGuardHomeDataUpdateCoordinator\\` class defines the \\`device_info\\` property TWICE:\n- First definition: lines 68-83\n- Second definition: lines 153-167\n\nPython uses the last definition, making the first one dead code that causes confusion.\n\n## Research\n- This is likely a copy-paste error during development\n- The second definition is more complete (includes host in device name)\n- Dead code increases maintenance burden and confusion\n\n## Location\n- File: \\`custom_components/adguard_home_extended/coordinator.py\\` lines 68-83 (duplicate to remove)\n\n## Fix Required\nDelete the first \\`device_info\\` property definition (lines 68-83). Keep the second one at lines 153-167.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:35:18.028482-05:00","updated_at":"2025-12-17T16:43:55.919793-05:00","closed_at":"2025-12-17T16:43:55.919793-05:00"}
{"id":"homeassistant_adguard_home-24l","title":"Diagnostics support","description":"Create diagnostics.py to provide troubleshooting data export with sensitive data redaction","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T15:53:28.217244-05:00","updated_at":"2025-12-17T16:26:16.896102-05:00","closed_at":"2025-12-17T16:26:16.896102-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-24l","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.168048-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-24l","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.668627-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-3q9","title":"Enhance hacs.json with recommended fields","description":"## Problem\nThe \\`hacs.json\\` file only contains minimal required fields. Adding optional fields improves HACS integration and user experience.\n\n## Research\nPer HACS documentation, recommended optional fields:\n- \\`render_readme\\`: true - Shows README in HACS UI\n- \\`country\\`: Array of country codes if region-specific\n- \\`hacs\\`: Minimum HACS version required\n\n## Current Content\n\\`\\`\\`json\n{\n  'name': 'AdGuard Home Extended',\n  'homeassistant': '2024.1.0'\n}\n\\`\\`\\`\n\n## Location\n- File: \\`hacs.json\\`\n\n## Fix Required\n\\`\\`\\`json\n{\n  'name': 'AdGuard Home Extended',\n  'homeassistant': '2024.1.0',\n  'render_readme': true\n}\n\\`\\`\\`","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T16:36:29.021357-05:00","updated_at":"2025-12-17T16:51:08.715884-05:00","closed_at":"2025-12-17T16:51:08.715884-05:00"}
{"id":"homeassistant_adguard_home-4bc","title":"Add service descriptions to translations","description":"## Problem\nService descriptions in \\`services.yaml\\` are in English only. For proper localization support, service names and descriptions should also be in \\`strings.json\\` and translation files.\n\n## Research\n- Home Assistant supports translated service names/descriptions\n- Format in strings.json:\n\\`\\`\\`json\n{\n  'services': {\n    'set_blocked_services': {\n      'name': 'Set Blocked Services',\n      'description': 'Set the list of services to block globally',\n      'fields': {\n        'services': {\n          'name': 'Services',\n          'description': 'List of service IDs to block'\n        }\n      }\n    }\n  }\n}\n\\`\\`\\`\n\n## Location\n- File: \\`custom_components/adguard_home_extended/strings.json\\`\n- File: \\`custom_components/adguard_home_extended/translations/en.json\\`\n\n## Fix Required\nAdd \\`services\\` section to strings.json with all service definitions from services.yaml","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T16:36:43.627537-05:00","updated_at":"2025-12-17T16:52:16.54959-05:00","closed_at":"2025-12-17T16:52:16.54959-05:00"}
{"id":"homeassistant_adguard_home-4jy","title":"Filter list management services","description":"Create HA services for: add_filter_url, remove_filter_url, enable_filter, disable_filter, refresh_filters","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:55.786514-05:00","updated_at":"2025-12-17T16:02:25.564901-05:00","closed_at":"2025-12-17T16:02:25.564901-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-4jy","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.905499-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-4jy","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.521052-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-4to","title":"Unregister services on integration unload","description":"## Problem\nThe \\`async_unload_entry\\` function does not unregister services when the integration is removed. If the user removes the last AdGuard Home config entry, stale services remain in Home Assistant and will cause errors when called.\n\n## Research\n- Home Assistant best practice: clean up services when last entry is unloaded\n- Stale services show in Developer Tools but fail with cryptic errors\n- Other well-maintained integrations handle this cleanup\n\n## Location\n- File: \\`custom_components/adguard_home_extended/__init__.py\\` lines 247-252\n\n## Fix Required\nAdd service cleanup when the last entry is unloaded:\n\\`\\`\\`python\nasync def async_unload_entry(hass: HomeAssistant, entry: ConfigEntry) -\u003e bool:\n    if unload_ok := await hass.config_entries.async_unload_platforms(entry, PLATFORMS):\n        hass.data[DOMAIN].pop(entry.entry_id)\n        \n        # Remove services if this was the last entry\n        if not hass.data[DOMAIN]:\n            for service in [SERVICE_SET_BLOCKED_SERVICES, SERVICE_ADD_FILTER_URL, ../..]:\n                hass.services.async_remove(DOMAIN, service)\n    return unload_ok\n\\`\\`\\`\n\n## Dependencies\nShould be addressed alongside homeassistant_adguard_home-xdm (multi-instance fix) for consistency.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T16:35:27.178258-05:00","updated_at":"2025-12-17T16:47:05.672347-05:00","closed_at":"2025-12-17T16:47:05.672347-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-4to","depends_on_id":"homeassistant_adguard_home-xdm","type":"blocks","created_at":"2025-12-17T16:35:31.136591-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-4ul","title":"AdGuard Home API client library","description":"Create async API client for AdGuard Home REST API with Basic Auth, covering: status, stats, protection toggles, filtering, clients, blocked services, DHCP","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-17T15:52:23.892843-05:00","updated_at":"2025-12-17T16:00:21.3243-05:00","closed_at":"2025-12-17T16:00:21.3243-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-4ul","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.640196-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-4ul","depends_on_id":"homeassistant_adguard_home-1bb","type":"blocks","created_at":"2025-12-17T15:53:47.237342-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-5g2","title":"Add EntityCategory.DIAGNOSTIC to appropriate sensors","description":"## Problem\nSensors that provide diagnostic/debug information should be marked with \\`entity_category=EntityCategory.DIAGNOSTIC\\`. This helps Home Assistant organize them in the UI under 'Diagnostic' rather than cluttering the main entity list.\n\n## Research\n- Home Assistant UI groups entities by category\n- Diagnostic entities are hidden by default in some views\n- Improves UX by separating primary entities from debug/stats info\n\n## Affected Sensors\n- \\`avg_processing_time\\` - Processing time is diagnostic\n- \\`recent_queries\\` - Query log is diagnostic\n- \\`dns_rewrites_count\\` - Rewrite count is diagnostic\n- \\`dhcp_leases_count\\` - Lease count is diagnostic\n- \\`dhcp_static_leases_count\\` - Static lease count is diagnostic\n\n## Location\n- File: \\`custom_components/adguard_home_extended/sensor.py\\`\n\n## Fix Required\nAdd to sensor descriptions:\n\\`\\`\\`python\nfrom homeassistant.helpers.entity import EntityCategory\n\nAdGuardHomeSensorEntityDescription(\n    key='avg_processing_time',\n    entity_category=EntityCategory.DIAGNOSTIC,\n    # ../..\n),\n\\`\\`\\`","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T16:36:18.957526-05:00","updated_at":"2025-12-17T16:50:49.136794-05:00","closed_at":"2025-12-17T16:50:49.136794-05:00"}
{"id":"homeassistant_adguard_home-5gv","title":"Add missing fields to AdGuardHomeStatus model","description":"## Problem\nThe \\`AdGuardHomeStatus\\` dataclass in \\`api/models.py\\` is missing critical fields that the AdGuard Home API returns:\n- \\`safebrowsing_enabled\\` (boolean)\n- \\`parental_enabled\\` (boolean)\n- \\`safesearch\\` (object with \\`enabled\\` field)\n\n## Research\nPer AdGuard Home's OpenAPI spec and REST API documentation:\n- The \\`/control/status\\` endpoint returns these fields in every response\n- These are needed to correctly display switch states in Home Assistant\n- The official HA core integration reads these fields\n\n## Location\n- File: \\`custom_components/adguard_home_extended/api/models.py\\` lines 11-30\n\n## Fix Required\nUpdate \\`AdGuardHomeStatus\\` dataclass and \\`from_dict\\` method to include:\n\\`\\`\\`python\nsafebrowsing_enabled: bool = False\nparental_enabled: bool = False\nsafesearch_enabled: bool = False\n\\`\\`\\`\n\nHandle \\`safesearch\\` as nested object: \\`data.get('safesearch', {}).get('enabled', False)\\`","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:34:36.894808-05:00","updated_at":"2025-12-17T16:39:49.4484-05:00","closed_at":"2025-12-17T16:39:49.4484-05:00"}
{"id":"homeassistant_adguard_home-5k9","title":"DataUpdateCoordinator implementation","description":"Create coordinator.py with DataUpdateCoordinator for polling AdGuard Home API. Handle connection errors gracefully with UpdateFailed","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-17T15:52:33.085114-05:00","updated_at":"2025-12-17T16:00:25.234761-05:00","closed_at":"2025-12-17T16:00:25.234761-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-5k9","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.716867-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-5k9","depends_on_id":"homeassistant_adguard_home-4ul","type":"blocks","created_at":"2025-12-17T15:53:47.315338-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-5xf","title":"Fix switch state reading for safe_browsing, parental_control, safe_search","description":"## Problem\nThe Safe Browsing, Parental Control, and Safe Search switches all incorrectly use \\`data.status.protection_enabled\\` for their \\`is_on_fn\\` lambda. This means they show the wrong state in the Home Assistant UI.\n\n## Research\n- AdGuard Home API \\`/control/status\\` returns individual boolean fields for each feature\n- The official HA core AdGuard integration correctly reads these separate states\n- Comments in code say 'Will be updated when we can read safebrowsing state' - but the API DOES support this\n\n## Location\n- File: \\`custom_components/adguard_home_extended/switch.py\\` lines 46-66\n\n## Fix Required\nUpdate each switch description's \\`is_on_fn\\`:\n\\`\\`\\`python\n# safe_browsing\nis_on_fn=lambda data: data.status.safebrowsing_enabled if data.status else None\n\n# parental_control  \nis_on_fn=lambda data: data.status.parental_enabled if data.status else None\n\n# safe_search\nis_on_fn=lambda data: data.status.safesearch_enabled if data.status else None\n\\`\\`\\`\n\n## Dependencies\nRequires homeassistant_adguard_home-5gv (AdGuardHomeStatus model fields) to be completed first.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:34:46.06856-05:00","updated_at":"2025-12-17T16:40:48.770928-05:00","closed_at":"2025-12-17T16:40:48.770928-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-5xf","depends_on_id":"homeassistant_adguard_home-5gv","type":"blocks","created_at":"2025-12-17T16:34:50.689615-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-6tu","title":"Sensor entities","description":"Create sensor.py with sensors for: DNS queries total, blocked queries, avg processing time, top blocked domains, top clients","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:37.859852-05:00","updated_at":"2025-12-17T16:00:31.794061-05:00","closed_at":"2025-12-17T16:00:31.794061-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-6tu","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.753872-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-6tu","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.354374-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-6zp","title":"Unit tests","description":"Create comprehensive pytest tests: API client tests, config flow tests, coordinator tests, entity tests. Use pytest-homeassistant-custom-component","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T15:53:18.666441-05:00","updated_at":"2025-12-17T16:10:44.571359-05:00","closed_at":"2025-12-17T16:10:44.571359-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-6zp","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.093287-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-9f0","title":"Fix query log sensor attribute field names","description":"## Problem\nThe \\`recent_queries\\` sensor uses incorrect field names to extract query log data. It uses uppercase keys like \\`QH\\`, \\`IP\\`, \\`Answer\\`, \\`Reason\\` but the AdGuard Home API returns different field names.\n\n## Research\nPer AdGuard Home API documentation, query log entries use:\n- \\`question.name\\` or \\`question.host\\` for the domain (nested object)\n- \\`client\\` for the client IP/name (not \\`IP\\`)\n- \\`answer\\` is an array of objects with \\`value\\` field\n- \\`reason\\` is lowercase\n\n## Location\n- File: \\`custom_components/adguard_home_extended/sensor.py\\` lines 182-192\n\n## Fix Required\n\\`\\`\\`python\n'recent_queries': [\n    {\n        'domain': q.get('question', {}).get('name', ''),\n        'client': q.get('client', ''),\n        'answer': q.get('answer', [{}])[0].get('value', '') if q.get('answer') else '',\n        'reason': q.get('reason', ''),\n    }\n    for q in data.query_log[:10]\n]\n\\`\\`\\`","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T16:36:00.988431-05:00","updated_at":"2025-12-17T16:48:18.052793-05:00","closed_at":"2025-12-17T16:48:18.052793-05:00"}
{"id":"homeassistant_adguard_home-a2b","title":"Dynamic client entity updates","description":"## Problem\nPer-client entities (filtering, parental, safebrowsing switches for each AdGuard client) are created only during integration setup. If users add, remove, or rename clients in AdGuard Home, the entities become stale and don't reflect the changes until a full integration reload.\n\n## Research\n- Home Assistant entity registry supports dynamic entity creation\n- Best practice is to compare current entities with coordinator data on updates\n- Some integrations use \\`async_add_entities\\` callbacks from coordinator listeners\n\n## Location\n- File: \\`custom_components/adguard_home_extended/client_entities.py\\` (current static creation)\n- File: \\`custom_components/adguard_home_extended/switch.py\\` lines 76-80 (setup entry)\n\n## Implementation\n1. Track created client entity IDs\n2. Add coordinator listener in switch platform setup\n3. On data refresh, compare \\`coordinator.data.clients\\` with tracked entities\n4. Call \\`async_add_entities\\` for new clients\n5. Optionally: mark removed client entities as unavailable or remove them","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T16:35:51.866033-05:00","updated_at":"2025-12-17T17:00:53.019279-05:00","closed_at":"2025-12-17T17:00:53.019279-05:00"}
{"id":"homeassistant_adguard_home-bh1","title":"Fix filtering switch to use correct API endpoint","description":"## Problem\nThe Filtering switch reads state from \\`data.filtering.enabled\\` but its \\`turn_on_fn\\` and \\`turn_off_fn\\` both call \\`client.set_protection()\\`. Protection and Filtering are different features in AdGuard Home.\n\n## Research\n- AdGuard Home has separate endpoints for protection vs filtering\n- \\`/control/protection\\` - Master protection toggle\n- \\`/control/filtering/config\\` or \\`/control/dns_config\\` - Filtering toggle\n- The current implementation toggles the wrong feature when user clicks the Filtering switch\n\n## Location\n- File: \\`custom_components/adguard_home_extended/switch.py\\` lines 42-45\n- File: \\`custom_components/adguard_home_extended/api/client.py\\` (missing method)\n\n## Fix Required\n1. Add new API method in \\`client.py\\`:\n\\`\\`\\`python\nasync def set_filtering(self, enabled: bool) -\u003e None:\n    await self._post('/control/filtering/config', {'enabled': enabled})\n\\`\\`\\`\n\n2. Update switch in \\`switch.py\\`:\n\\`\\`\\`python\nturn_on_fn=lambda client: client.set_filtering(True),\nturn_off_fn=lambda client: client.set_filtering(False),\n\\`\\`\\`","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:34:59.319197-05:00","updated_at":"2025-12-17T16:43:24.54233-05:00","closed_at":"2025-12-17T16:43:24.54233-05:00"}
{"id":"homeassistant_adguard_home-bjp","title":"HACS and repository setup","description":"Create hacs.json, README.md with installation/usage docs, LICENSE file. Prepare for HACS default repository submission","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T15:53:23.778905-05:00","updated_at":"2025-12-17T16:00:31.908492-05:00","closed_at":"2025-12-17T16:00:31.908492-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-bjp","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.131375-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-bws","title":"Per-client filtering entities","description":"Create entities for per-client control: enable/disable filtering per device, per-client parental controls, per-client blocked services","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:51.282419-05:00","updated_at":"2025-12-17T16:06:24.206008-05:00","closed_at":"2025-12-17T16:06:24.206008-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-bws","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.868684-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-bws","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.478959-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-bwx","title":"Implement OptionsFlow for configurable scan interval","description":"## Problem\nUsers cannot modify the scan interval (polling frequency) after initial setup. The \\`DEFAULT_SCAN_INTERVAL\\` of 30 seconds is hardcoded. Some users may want faster updates, others may want to reduce API calls.\n\n## Research\n- HACS integrations commonly provide OptionsFlow for polling configuration\n- Home Assistant DataUpdateCoordinator supports dynamic update intervals\n- The official AdGuard Home core integration also lacks this, but it's a good enhancement opportunity\n\n## Location\n- File: \\`custom_components/adguard_home_extended/config_flow.py\\` (add OptionsFlowHandler)\n- File: \\`custom_components/adguard_home_extended/coordinator.py\\` (read from entry.options)\n- File: \\`custom_components/adguard_home_extended/const.py\\` (add config key)\n\n## Implementation\n1. Add \\`OptionsFlowHandler\\` class to config_flow.py\n2. Register options flow in \\`AdGuardHomeConfigFlow\\`\n3. Update coordinator to read interval from \\`entry.options.get(CONF_SCAN_INTERVAL, DEFAULT_SCAN_INTERVAL)\\`\n4. Add listener for options updates to apply changes without restart","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T16:35:42.183542-05:00","updated_at":"2025-12-17T16:58:44.244358-05:00","closed_at":"2025-12-17T16:58:44.244358-05:00"}
{"id":"homeassistant_adguard_home-emr","title":"DHCP sensors","description":"Create sensors for DHCP data: active leases count, static leases, lease details as attributes","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T15:53:09.04395-05:00","updated_at":"2025-12-17T16:26:16.852387-05:00","closed_at":"2025-12-17T16:26:16.852387-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-emr","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.020783-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-emr","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.632668-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-ha1","title":"Sync translations/en.json with strings.json","description":"## Problem\nHome Assistant uses both \\`strings.json\\` and \\`translations/en.json\\` for localization. These files should be identical for the English locale, but they may have drifted apart.\n\n## Research\n- \\`strings.json\\` is the source of truth for config flow strings\n- \\`translations/en.json\\` is loaded by Home Assistant for runtime translations\n- Best practice: keep them synchronized or use a build process\n\n## Location\n- File: \\`custom_components/adguard_home_extended/strings.json\\`\n- File: \\`custom_components/adguard_home_extended/translations/en.json\\`\n\n## Fix Required\n1. Compare both files\n2. Ensure \\`translations/en.json\\` contains all keys from \\`strings.json\\`\n3. Consider adding a CI check to verify synchronization","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T16:36:36.501172-05:00","updated_at":"2025-12-17T16:51:36.051228-05:00","closed_at":"2025-12-17T16:51:36.051228-05:00"}
{"id":"homeassistant_adguard_home-iyj","title":"Translations and strings","description":"Create strings.json and translations/en.json for all entities, services, config flow steps, and error messages","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T15:53:13.732271-05:00","updated_at":"2025-12-17T16:00:31.872535-05:00","closed_at":"2025-12-17T16:00:31.872535-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-iyj","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.056145-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-izj","title":"DNS rewrite management","description":"Create services and entities for DNS rewrite rules management: list rewrites, add rewrite, remove rewrite","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T15:53:00.440617-05:00","updated_at":"2025-12-17T16:26:16.42144-05:00","closed_at":"2025-12-17T16:26:16.42144-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-izj","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.944807-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-izj","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.558682-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-m2g","title":"Config flow implementation","description":"Create config_flow.py with UI wizard for host, port, username, password, SSL verification. Include connection validation and reauthentication support","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-17T15:52:28.984226-05:00","updated_at":"2025-12-17T16:00:21.367977-05:00","closed_at":"2025-12-17T16:00:21.367977-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-m2g","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.676203-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-m2g","depends_on_id":"homeassistant_adguard_home-1bb","type":"blocks","created_at":"2025-12-17T15:53:47.278271-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-ncl","title":"Update blocked_services API payload format for v0.107.37+","description":"## Problem\nThe \\`set_blocked_services\\` method sends a plain list to the API:\n\\`\\`\\`python\nawait self._post(API_BLOCKED_SERVICES_SET, services)\n\\`\\`\\`\n\nHowever, AdGuard Home v0.107.37+ changed the API to expect a different format with schedule support.\n\n## Research\nPer AdGuard Home changelog and API updates:\n- Old format (pre-0.107.37): \\`['service1', 'service2']\\`\n- New format (0.107.37+): \\`{'ids': ['service1', 'service2'], 'schedule': {...}}\\`\n- The old format may still work but could break in future versions\n\n## Location\n- File: \\`custom_components/adguard_home_extended/api/client.py\\` line 265\n\n## Fix Required\nUpdate to use the new format:\n\\`\\`\\`python\nasync def set_blocked_services(self, services: list[str]) -\u003e None:\n    await self._post(API_BLOCKED_SERVICES_SET, {\n        'ids': services,\n        'schedule': {'time_zone': 'Local'}  # or appropriate default\n    })\n\\`\\`\\`\n\nConsider also checking AdGuard Home version and using appropriate format.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T16:36:10.312576-05:00","updated_at":"2025-12-17T16:49:26.504238-05:00","closed_at":"2025-12-17T16:49:26.504238-05:00"}
{"id":"homeassistant_adguard_home-ota","title":"Query log sensors","description":"Create sensors for query log data: recent queries, recent blocked queries, query log statistics","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T15:53:04.547317-05:00","updated_at":"2025-12-17T16:26:16.661712-05:00","closed_at":"2025-12-17T16:26:16.661712-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-ota","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.980854-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-ota","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.596117-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-ply","title":"Blocked services switches","description":"Create switches to toggle blocking of specific services: social media (TikTok, Instagram, etc.), streaming (Netflix, YouTube), AI services (ChatGPT, Claude)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:46.739378-05:00","updated_at":"2025-12-17T16:02:25.526722-05:00","closed_at":"2025-12-17T16:02:25.526722-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-ply","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.829094-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-ply","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.437339-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-xdm","title":"Fix multi-instance service registration","description":"## Problem\nServices are registered globally with \\`if not hass.services.has_service(...)\\` guard, but the service handlers capture the \\`coordinator\\` from whichever config entry is set up first. With multiple AdGuard Home instances, ALL service calls go to the first instance regardless of user intent.\n\n## Research\n- Home Assistant best practice: services should either use entity targets or look up the correct coordinator\n- The current pattern breaks for any user with 2+ AdGuard Home servers\n- Official integrations use device/entity targeting for multi-instance support\n\n## Location\n- File: \\`custom_components/adguard_home_extended/__init__.py\\` lines 85 and 161-244\n\n## Fix Required\nOption A (Recommended): Refactor services to accept a \\`device_id\\` or \\`entry_id\\` parameter and look up the correct coordinator:\n\\`\\`\\`python\nasync def handle_set_blocked_services(call: ServiceCall) -\u003e None:\n    # Look up coordinator from hass.data based on target\n    entry_id = call.data.get('entry_id')\n    if entry_id and entry_id in hass.data[DOMAIN]:\n        coordinator = hass.data[DOMAIN][entry_id]\n    elif len(hass.data[DOMAIN]) == 1:\n        coordinator = next(iter(hass.data[DOMAIN].values()))\n    else:\n        raise ServiceValidationError('Must specify entry_id with multiple instances')\n    # ../.. rest of handler\n\\`\\`\\`\n\nOption B: Convert to entity services that automatically target the correct device.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:35:10.221737-05:00","updated_at":"2025-12-17T16:46:54.335977-05:00","closed_at":"2025-12-17T16:46:54.335977-05:00"}
{"id":"homeassistant_adguard_home-yns","title":"Switch entities - protection toggles","description":"Create switch.py with switches for: global protection, safe browsing, parental control, safe search enforcement","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:42.110974-05:00","updated_at":"2025-12-17T16:00:31.833492-05:00","closed_at":"2025-12-17T16:00:31.833492-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-yns","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.791167-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-yns","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.392432-05:00","created_by":"daemon"}]}
