{"id":"homeassistant_adguard_home-0d8","title":"AdGuard Home Extended HACS Integration","description":"Build a comprehensive HACS integration for AdGuard Home with extended features beyond the core integration","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-17T15:52:08.727652-05:00","updated_at":"2025-12-17T16:26:27.861995-05:00","closed_at":"2025-12-17T16:26:27.861995-05:00"}
{"id":"homeassistant_adguard_home-0lx","title":"Add blocked services schedule support","description":"## Background\nAdGuard Home v0.107.37+ changed the blocked services API format from a simple list to an object with schedule support:\n\n**Old format (pre-0.107.37):**\n\\`\\`\\`json\n[\"facebook\", \"youtube\", \"tiktok\"]\n\\`\\`\\`\n\n**New format (0.107.37+):**\n\\`\\`\\`json\n{\n  \"ids\": [\"facebook\", \"youtube\", \"tiktok\"],\n  \"schedule\": {\n    \"time_zone\": \"America/New_York\",\n    \"mon\": {\"start\": 0, \"end\": 86399999},\n    ../..\n  }\n}\n\\`\\`\\`\n\n## Current State\nThe integration correctly handles both formats for **reading** (client.py:274-284), but only supports the basic \\`ids\\` array for **writing**. Schedule functionality is not exposed.\n\n## Required Changes\n1. Add schedule parameters to \\`set_blocked_services()\\` method\n2. Create new service \\`set_blocked_services_schedule\\` \n3. Add sensors/attributes showing schedule status\n\n## Use Case\nUsers can schedule when services are blocked (e.g., block social media during work hours, allow after 6pm).\n\n## Research Source\nAdGuard Home Release Notes v0.107.37: 'Service blocking pause schedule - Users can now easily set pauses for the service blocking filter'","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-17T18:16:27.569473-05:00","updated_at":"2025-12-17T18:16:27.569473-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-0lx","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:17:52.341927-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-1bb","title":"Project scaffolding and structure","description":"Create base project structure: custom_components/adguard_home_extended/, manifest.json, const.py, __init__.py","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-17T15:52:14.287541-05:00","updated_at":"2025-12-17T15:59:33.948677-05:00","closed_at":"2025-12-17T15:59:33.948677-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-1bb","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.604377-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-1zv","title":"Remove duplicate device_info property in coordinator","description":"## Problem\nThe \\`AdGuardHomeDataUpdateCoordinator\\` class defines the \\`device_info\\` property TWICE:\n- First definition: lines 68-83\n- Second definition: lines 153-167\n\nPython uses the last definition, making the first one dead code that causes confusion.\n\n## Research\n- This is likely a copy-paste error during development\n- The second definition is more complete (includes host in device name)\n- Dead code increases maintenance burden and confusion\n\n## Location\n- File: \\`custom_components/adguard_home_extended/coordinator.py\\` lines 68-83 (duplicate to remove)\n\n## Fix Required\nDelete the first \\`device_info\\` property definition (lines 68-83). Keep the second one at lines 153-167.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:35:18.028482-05:00","updated_at":"2025-12-17T16:43:55.919793-05:00","closed_at":"2025-12-17T16:43:55.919793-05:00"}
{"id":"homeassistant_adguard_home-23z","title":"Expand SafeSearch API support for per-engine control","description":"## Background\nIn AdGuard Home 0.107.x, SafeSearch became a complex object allowing per-search-engine control.\n\n## API Response Structure\n\\`\\`\\`json\n{\n  \"safesearch\": {\n    \"enabled\": true,\n    \"bing\": true,\n    \"duckduckgo\": true,\n    \"google\": true,\n    \"pixabay\": true,\n    \"yandex\": true,\n    \"youtube\": true\n  }\n}\n\\`\\`\\`\n\n## Current State\n- Reading: Correctly extracts \\`enabled\\` boolean from the object (models.py:26-35)\n- Writing: Only uses enable/disable endpoints, no per-engine control\n\n## Required Changes\n1. Add \\`SafeSearchSettings\\` model with all engine fields\n2. Add \\`GET/POST /control/safesearch/settings\\` API methods\n3. Create per-engine switches or a service to configure granular settings\n\n## Use Case\nUsers may want SafeSearch on Google/YouTube but not other engines.\n\n## Research Source\nAdGuard Home API shows safesearch is now an object with per-engine boolean fields, configurable via /control/safesearch/settings endpoint","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-17T18:17:43.000847-05:00","updated_at":"2025-12-17T18:17:43.000847-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-23z","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:18:02.036184-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-24l","title":"Diagnostics support","description":"Create diagnostics.py to provide troubleshooting data export with sensitive data redaction","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T15:53:28.217244-05:00","updated_at":"2025-12-17T16:26:16.896102-05:00","closed_at":"2025-12-17T16:26:16.896102-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-24l","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.168048-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-24l","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.668627-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-3pm","title":"Fix query log search parameter not being used in URL","description":"## Problem\nIn \\`client.py:304-312\\`, the \\`search\\` parameter is accepted but never actually added to the request URL.\n\n## Current Code\n\\`\\`\\`python\nasync def get_query_log(\n    self,\n    limit: int = 100,\n    offset: int = 0,\n    search: str | None = None,\n) -\u003e list[dict]:\n    params = {\"limit\": limit, \"offset\": offset}\n    if search:\n        params[\"search\"] = search  # \u003c-- params dict created but not used\n    data = await self._get(f\"{API_QUERYLOG}?limit={limit}\u0026offset={offset}\")  # \u003c-- search missing\n    return data.get(\"data\", []) if data else []\n\\`\\`\\`\n\n## Required Fix\n\\`\\`\\`python\nasync def get_query_log(\n    self,\n    limit: int = 100,\n    offset: int = 0,\n    search: str | None = None,\n) -\u003e list[dict]:\n    url = f\"{API_QUERYLOG}?limit={limit}\u0026offset={offset}\"\n    if search:\n        url += f\"\u0026search={search}\"\n    data = await self._get(url)\n    return data.get(\"data\", []) if data else []\n\\`\\`\\`\n\n## Impact\nUsers cannot filter query log results by search term even though the parameter exists in the function signature.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-17T18:15:57.899763-05:00","updated_at":"2025-12-17T18:22:46.440827-05:00","closed_at":"2025-12-17T18:22:46.440827-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-3pm","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:17:52.230663-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-3q9","title":"Enhance hacs.json with recommended fields","description":"## Problem\nThe \\`hacs.json\\` file only contains minimal required fields. Adding optional fields improves HACS integration and user experience.\n\n## Research\nPer HACS documentation, recommended optional fields:\n- \\`render_readme\\`: true - Shows README in HACS UI\n- \\`country\\`: Array of country codes if region-specific\n- \\`hacs\\`: Minimum HACS version required\n\n## Current Content\n\\`\\`\\`json\n{\n  'name': 'AdGuard Home Extended',\n  'homeassistant': '2024.1.0'\n}\n\\`\\`\\`\n\n## Location\n- File: \\`hacs.json\\`\n\n## Fix Required\n\\`\\`\\`json\n{\n  'name': 'AdGuard Home Extended',\n  'homeassistant': '2024.1.0',\n  'render_readme': true\n}\n\\`\\`\\`","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T16:36:29.021357-05:00","updated_at":"2025-12-17T16:51:08.715884-05:00","closed_at":"2025-12-17T16:51:08.715884-05:00"}
{"id":"homeassistant_adguard_home-4bc","title":"Add service descriptions to translations","description":"## Problem\nService descriptions in \\`services.yaml\\` are in English only. For proper localization support, service names and descriptions should also be in \\`strings.json\\` and translation files.\n\n## Research\n- Home Assistant supports translated service names/descriptions\n- Format in strings.json:\n\\`\\`\\`json\n{\n  'services': {\n    'set_blocked_services': {\n      'name': 'Set Blocked Services',\n      'description': 'Set the list of services to block globally',\n      'fields': {\n        'services': {\n          'name': 'Services',\n          'description': 'List of service IDs to block'\n        }\n      }\n    }\n  }\n}\n\\`\\`\\`\n\n## Location\n- File: \\`custom_components/adguard_home_extended/strings.json\\`\n- File: \\`custom_components/adguard_home_extended/translations/en.json\\`\n\n## Fix Required\nAdd \\`services\\` section to strings.json with all service definitions from services.yaml","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T16:36:43.627537-05:00","updated_at":"2025-12-17T16:52:16.54959-05:00","closed_at":"2025-12-17T16:52:16.54959-05:00"}
{"id":"homeassistant_adguard_home-4jy","title":"Filter list management services","description":"Create HA services for: add_filter_url, remove_filter_url, enable_filter, disable_filter, refresh_filters","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:55.786514-05:00","updated_at":"2025-12-17T16:02:25.564901-05:00","closed_at":"2025-12-17T16:02:25.564901-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-4jy","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.905499-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-4jy","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.521052-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-4to","title":"Unregister services on integration unload","description":"## Problem\nThe \\`async_unload_entry\\` function does not unregister services when the integration is removed. If the user removes the last AdGuard Home config entry, stale services remain in Home Assistant and will cause errors when called.\n\n## Research\n- Home Assistant best practice: clean up services when last entry is unloaded\n- Stale services show in Developer Tools but fail with cryptic errors\n- Other well-maintained integrations handle this cleanup\n\n## Location\n- File: \\`custom_components/adguard_home_extended/__init__.py\\` lines 247-252\n\n## Fix Required\nAdd service cleanup when the last entry is unloaded:\n\\`\\`\\`python\nasync def async_unload_entry(hass: HomeAssistant, entry: ConfigEntry) -\u003e bool:\n    if unload_ok := await hass.config_entries.async_unload_platforms(entry, PLATFORMS):\n        hass.data[DOMAIN].pop(entry.entry_id)\n        \n        # Remove services if this was the last entry\n        if not hass.data[DOMAIN]:\n            for service in [SERVICE_SET_BLOCKED_SERVICES, SERVICE_ADD_FILTER_URL, ../..]:\n                hass.services.async_remove(DOMAIN, service)\n    return unload_ok\n\\`\\`\\`\n\n## Dependencies\nShould be addressed alongside homeassistant_adguard_home-xdm (multi-instance fix) for consistency.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T16:35:27.178258-05:00","updated_at":"2025-12-17T16:47:05.672347-05:00","closed_at":"2025-12-17T16:47:05.672347-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-4to","depends_on_id":"homeassistant_adguard_home-xdm","type":"blocks","created_at":"2025-12-17T16:35:31.136591-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-4ul","title":"AdGuard Home API client library","description":"Create async API client for AdGuard Home REST API with Basic Auth, covering: status, stats, protection toggles, filtering, clients, blocked services, DHCP","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-17T15:52:23.892843-05:00","updated_at":"2025-12-17T16:00:21.3243-05:00","closed_at":"2025-12-17T16:00:21.3243-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-4ul","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.640196-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-4ul","depends_on_id":"homeassistant_adguard_home-1bb","type":"blocks","created_at":"2025-12-17T15:53:47.237342-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-53z","title":"Integration Audit - API \u0026 HA Compatibility","description":"Complete audit of AdGuard Home Extended integration for compatibility with:\n- AdGuard Home v0.107.69 (latest stable Dec 2025)\n- Home Assistant 2024.12.x / 2025.1.0+\n\nThis epic tracks all identified issues from the comprehensive audit including API compatibility, Home Assistant integration patterns, and code quality improvements.","status":"in_progress","priority":1,"issue_type":"epic","created_at":"2025-12-17T18:15:40.386438-05:00","updated_at":"2025-12-17T18:19:09.669006-05:00"}
{"id":"homeassistant_adguard_home-5g2","title":"Add EntityCategory.DIAGNOSTIC to appropriate sensors","description":"## Problem\nSensors that provide diagnostic/debug information should be marked with \\`entity_category=EntityCategory.DIAGNOSTIC\\`. This helps Home Assistant organize them in the UI under 'Diagnostic' rather than cluttering the main entity list.\n\n## Research\n- Home Assistant UI groups entities by category\n- Diagnostic entities are hidden by default in some views\n- Improves UX by separating primary entities from debug/stats info\n\n## Affected Sensors\n- \\`avg_processing_time\\` - Processing time is diagnostic\n- \\`recent_queries\\` - Query log is diagnostic\n- \\`dns_rewrites_count\\` - Rewrite count is diagnostic\n- \\`dhcp_leases_count\\` - Lease count is diagnostic\n- \\`dhcp_static_leases_count\\` - Static lease count is diagnostic\n\n## Location\n- File: \\`custom_components/adguard_home_extended/sensor.py\\`\n\n## Fix Required\nAdd to sensor descriptions:\n\\`\\`\\`python\nfrom homeassistant.helpers.entity import EntityCategory\n\nAdGuardHomeSensorEntityDescription(\n    key='avg_processing_time',\n    entity_category=EntityCategory.DIAGNOSTIC,\n    # ../..\n),\n\\`\\`\\`","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T16:36:18.957526-05:00","updated_at":"2025-12-17T16:50:49.136794-05:00","closed_at":"2025-12-17T16:50:49.136794-05:00"}
{"id":"homeassistant_adguard_home-5gv","title":"Add missing fields to AdGuardHomeStatus model","description":"## Problem\nThe \\`AdGuardHomeStatus\\` dataclass in \\`api/models.py\\` is missing critical fields that the AdGuard Home API returns:\n- \\`safebrowsing_enabled\\` (boolean)\n- \\`parental_enabled\\` (boolean)\n- \\`safesearch\\` (object with \\`enabled\\` field)\n\n## Research\nPer AdGuard Home's OpenAPI spec and REST API documentation:\n- The \\`/control/status\\` endpoint returns these fields in every response\n- These are needed to correctly display switch states in Home Assistant\n- The official HA core integration reads these fields\n\n## Location\n- File: \\`custom_components/adguard_home_extended/api/models.py\\` lines 11-30\n\n## Fix Required\nUpdate \\`AdGuardHomeStatus\\` dataclass and \\`from_dict\\` method to include:\n\\`\\`\\`python\nsafebrowsing_enabled: bool = False\nparental_enabled: bool = False\nsafesearch_enabled: bool = False\n\\`\\`\\`\n\nHandle \\`safesearch\\` as nested object: \\`data.get('safesearch', {}).get('enabled', False)\\`","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:34:36.894808-05:00","updated_at":"2025-12-17T16:39:49.4484-05:00","closed_at":"2025-12-17T16:39:49.4484-05:00"}
{"id":"homeassistant_adguard_home-5k9","title":"DataUpdateCoordinator implementation","description":"Create coordinator.py with DataUpdateCoordinator for polling AdGuard Home API. Handle connection errors gracefully with UpdateFailed","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-17T15:52:33.085114-05:00","updated_at":"2025-12-17T16:00:25.234761-05:00","closed_at":"2025-12-17T16:00:25.234761-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-5k9","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.716867-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-5k9","depends_on_id":"homeassistant_adguard_home-4ul","type":"blocks","created_at":"2025-12-17T15:53:47.315338-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-5xf","title":"Fix switch state reading for safe_browsing, parental_control, safe_search","description":"## Problem\nThe Safe Browsing, Parental Control, and Safe Search switches all incorrectly use \\`data.status.protection_enabled\\` for their \\`is_on_fn\\` lambda. This means they show the wrong state in the Home Assistant UI.\n\n## Research\n- AdGuard Home API \\`/control/status\\` returns individual boolean fields for each feature\n- The official HA core AdGuard integration correctly reads these separate states\n- Comments in code say 'Will be updated when we can read safebrowsing state' - but the API DOES support this\n\n## Location\n- File: \\`custom_components/adguard_home_extended/switch.py\\` lines 46-66\n\n## Fix Required\nUpdate each switch description's \\`is_on_fn\\`:\n\\`\\`\\`python\n# safe_browsing\nis_on_fn=lambda data: data.status.safebrowsing_enabled if data.status else None\n\n# parental_control  \nis_on_fn=lambda data: data.status.parental_enabled if data.status else None\n\n# safe_search\nis_on_fn=lambda data: data.status.safesearch_enabled if data.status else None\n\\`\\`\\`\n\n## Dependencies\nRequires homeassistant_adguard_home-5gv (AdGuardHomeStatus model fields) to be completed first.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:34:46.06856-05:00","updated_at":"2025-12-17T16:40:48.770928-05:00","closed_at":"2025-12-17T16:40:48.770928-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-5xf","depends_on_id":"homeassistant_adguard_home-5gv","type":"blocks","created_at":"2025-12-17T16:34:50.689615-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-6tu","title":"Sensor entities","description":"Create sensor.py with sensors for: DNS queries total, blocked queries, avg processing time, top blocked domains, top clients","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:37.859852-05:00","updated_at":"2025-12-17T16:00:31.794061-05:00","closed_at":"2025-12-17T16:00:31.794061-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-6tu","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.753872-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-6tu","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.354374-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-6zp","title":"Unit tests","description":"Create comprehensive pytest tests: API client tests, config flow tests, coordinator tests, entity tests. Use pytest-homeassistant-custom-component","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T15:53:18.666441-05:00","updated_at":"2025-12-17T16:10:44.571359-05:00","closed_at":"2025-12-17T16:10:44.571359-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-6zp","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.093287-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-7th","title":"Clean up ClientEntityManager on config entry unload","description":"## Problem\nThe \\`ClientEntityManager\\` subscribes to coordinator updates to dynamically add client entities, but its \\`async_unsubscribe()\\` method is never called when the config entry is unloaded. This creates memory leaks as the listener persists indefinitely.\n\n## Location\n- File: \\`switch.py\\` lines 85-89 (manager storage)\n- File: \\`__init__.py\\` lines 291-310 (async_unload_entry)\n\n## Current Code in async_unload_entry\n\\`\\`\\`python\nasync def async_unload_entry(hass: HomeAssistant, entry: ConfigEntry) -\u003e bool:\n    if unload_ok := await hass.config_entries.async_unload_platforms(entry, PLATFORMS):\n        hass.data[DOMAIN].pop(entry.entry_id)\n        # ../.. services cleanup but NO client manager cleanup\n\\`\\`\\`\n\n## Recommended Fix\n\\`\\`\\`python\nasync def async_unload_entry(hass: HomeAssistant, entry: ConfigEntry) -\u003e bool:\n    # Clean up client entity manager first\n    if client_manager := hass.data[DOMAIN].get(\"client_managers\", {}).pop(entry.entry_id, None):\n        client_manager.async_unsubscribe()\n    \n    if unload_ok := await hass.config_entries.async_unload_platforms(entry, PLATFORMS):\n        hass.data[DOMAIN].pop(entry.entry_id)\n        # ../.. rest of cleanup\n\\`\\`\\`\n\n## Rationale\nThe ClientEntityManager stores a reference via \\`self._unsubscribe = self._coordinator.async_add_listener(...)\\`. Without calling \\`async_unsubscribe()\\`, the coordinator retains a reference to the callback, preventing garbage collection and causing the callback to fire even after the entry is unloaded.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T17:08:14.280936-05:00","updated_at":"2025-12-17T17:16:46.90535-05:00","closed_at":"2025-12-17T17:16:46.90535-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-7th","depends_on_id":"homeassistant_adguard_home-a0m","type":"blocks","created_at":"2025-12-17T17:09:43.493577-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-8hj","title":"Make sensor attribute list truncations configurable","description":"## Problem\nSensor attributes like top_blocked_domains and top_clients are truncated with hardcoded limits (\\`[:10]\\`, \\`[:20]\\`), which may not suit all users.\n\n## Location\n- File: \\`sensor.py\\` lines 107, 118, 134\n\n## Current Code Examples\n\\`\\`\\`python\n# Line 107\nattributes_fn=lambda data: (\n    {\"top_blocked_domains\": data.stats.top_blocked_domains[:10]}\n    if data.stats else {}\n),\n# Line 134\n{\"rewrites\": [...data.rewrites[:20]]}\n\\`\\`\\`\n\n## Recommended Enhancement\n1. Add constants: \\`DEFAULT_TOP_ITEMS_LIMIT = 10\\`, \\`DEFAULT_REWRITES_LIMIT = 20\\`\n2. Consider making configurable via options flow in future\n3. Use constants instead of magic numbers for now\n\n## Rationale\nPower users may want to see more items in sensor attributes for dashboards or automations, while constrained systems may prefer fewer. Using named constants improves code clarity and prepares for future configurability.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T17:08:59.713512-05:00","updated_at":"2025-12-17T18:09:50.172108-05:00","closed_at":"2025-12-17T18:09:50.172108-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-8hj","depends_on_id":"homeassistant_adguard_home-grl","type":"blocks","created_at":"2025-12-17T17:09:53.051426-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-8uk","title":"Add async_set_unique_id in config_flow","description":"## Problem\nThe config flow uses \\`_async_abort_entries_match\\` to check for duplicates but never calls \\`async_set_unique_id()\\`. Without a unique ID, Home Assistant cannot reliably manage the config entry, which causes issues with entity registration, options flows, and re-authentication.\n\n## Location\n- File: \\`config_flow.py\\` lines 65-70\n\n## Current Code\n\\`\\`\\`python\nif user_input is not None:\n    # Check if already configured\n    self._async_abort_entries_match({CONF_HOST: user_input[CONF_HOST]})\n\\`\\`\\`\n\n## Recommended Fix\n\\`\\`\\`python\nif user_input is not None:\n    # Set unique_id before checking duplicates\n    unique_id = f\"{user_input[CONF_HOST]}:{user_input[CONF_PORT]}\"\n    await self.async_set_unique_id(unique_id)\n    self._abort_if_unique_id_configured()\n\\`\\`\\`\n\n## Rationale\nPer Home Assistant developer docs, config entries should have a unique_id set via \\`async_set_unique_id()\\` to enable proper entry management, prevent duplicates atomically, and support features like discovery and re-authentication.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-17T17:07:55.044779-05:00","updated_at":"2025-12-17T17:12:39.916612-05:00","closed_at":"2025-12-17T17:12:39.916612-05:00"}
{"id":"homeassistant_adguard_home-9f0","title":"Fix query log sensor attribute field names","description":"## Problem\nThe \\`recent_queries\\` sensor uses incorrect field names to extract query log data. It uses uppercase keys like \\`QH\\`, \\`IP\\`, \\`Answer\\`, \\`Reason\\` but the AdGuard Home API returns different field names.\n\n## Research\nPer AdGuard Home API documentation, query log entries use:\n- \\`question.name\\` or \\`question.host\\` for the domain (nested object)\n- \\`client\\` for the client IP/name (not \\`IP\\`)\n- \\`answer\\` is an array of objects with \\`value\\` field\n- \\`reason\\` is lowercase\n\n## Location\n- File: \\`custom_components/adguard_home_extended/sensor.py\\` lines 182-192\n\n## Fix Required\n\\`\\`\\`python\n'recent_queries': [\n    {\n        'domain': q.get('question', {}).get('name', ''),\n        'client': q.get('client', ''),\n        'answer': q.get('answer', [{}])[0].get('value', '') if q.get('answer') else '',\n        'reason': q.get('reason', ''),\n    }\n    for q in data.query_log[:10]\n]\n\\`\\`\\`","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T16:36:00.988431-05:00","updated_at":"2025-12-17T16:48:18.052793-05:00","closed_at":"2025-12-17T16:48:18.052793-05:00"}
{"id":"homeassistant_adguard_home-a0m","title":"Fix service registration race condition","description":"## Problem\nThe current service registration uses \\`hass.services.has_service()\\` which is not atomic and can lead to race conditions if multiple AdGuard Home instances are set up concurrently.\n\n## Location\n- File: \\`__init__.py\\` lines 101-102\n\n## Current Code\n\\`\\`\\`python\n# Register services only once (first entry)\nif not hass.services.has_service(DOMAIN, SERVICE_SET_BLOCKED_SERVICES):\n    await _async_setup_services(hass)\n\\`\\`\\`\n\n## Recommended Fix\n\\`\\`\\`python\n# Track registration state atomically in hass.data\nif not hass.data[DOMAIN].get(\"services_registered\"):\n    await _async_setup_services(hass)\n    hass.data[DOMAIN][\"services_registered\"] = True\n\\`\\`\\`\n\n## Rationale\nThe \\`has_service\\` check is not atomic - if two config entries are set up at the same time (e.g., during HA startup with multiple AdGuard instances), both could pass the check before either registers, leading to duplicate registration attempts or other undefined behavior. Tracking state in \\`hass.data\\` provides atomic check-and-set semantics within the event loop.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-17T17:08:03.759662-05:00","updated_at":"2025-12-17T17:13:03.609237-05:00","closed_at":"2025-12-17T17:13:03.609237-05:00"}
{"id":"homeassistant_adguard_home-a2b","title":"Dynamic client entity updates","description":"## Problem\nPer-client entities (filtering, parental, safebrowsing switches for each AdGuard client) are created only during integration setup. If users add, remove, or rename clients in AdGuard Home, the entities become stale and don't reflect the changes until a full integration reload.\n\n## Research\n- Home Assistant entity registry supports dynamic entity creation\n- Best practice is to compare current entities with coordinator data on updates\n- Some integrations use \\`async_add_entities\\` callbacks from coordinator listeners\n\n## Location\n- File: \\`custom_components/adguard_home_extended/client_entities.py\\` (current static creation)\n- File: \\`custom_components/adguard_home_extended/switch.py\\` lines 76-80 (setup entry)\n\n## Implementation\n1. Track created client entity IDs\n2. Add coordinator listener in switch platform setup\n3. On data refresh, compare \\`coordinator.data.clients\\` with tracked entities\n4. Call \\`async_add_entities\\` for new clients\n5. Optionally: mark removed client entities as unavailable or remove them","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T16:35:51.866033-05:00","updated_at":"2025-12-17T17:00:53.019279-05:00","closed_at":"2025-12-17T17:00:53.019279-05:00"}
{"id":"homeassistant_adguard_home-bh1","title":"Fix filtering switch to use correct API endpoint","description":"## Problem\nThe Filtering switch reads state from \\`data.filtering.enabled\\` but its \\`turn_on_fn\\` and \\`turn_off_fn\\` both call \\`client.set_protection()\\`. Protection and Filtering are different features in AdGuard Home.\n\n## Research\n- AdGuard Home has separate endpoints for protection vs filtering\n- \\`/control/protection\\` - Master protection toggle\n- \\`/control/filtering/config\\` or \\`/control/dns_config\\` - Filtering toggle\n- The current implementation toggles the wrong feature when user clicks the Filtering switch\n\n## Location\n- File: \\`custom_components/adguard_home_extended/switch.py\\` lines 42-45\n- File: \\`custom_components/adguard_home_extended/api/client.py\\` (missing method)\n\n## Fix Required\n1. Add new API method in \\`client.py\\`:\n\\`\\`\\`python\nasync def set_filtering(self, enabled: bool) -\u003e None:\n    await self._post('/control/filtering/config', {'enabled': enabled})\n\\`\\`\\`\n\n2. Update switch in \\`switch.py\\`:\n\\`\\`\\`python\nturn_on_fn=lambda client: client.set_filtering(True),\nturn_off_fn=lambda client: client.set_filtering(False),\n\\`\\`\\`","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:34:59.319197-05:00","updated_at":"2025-12-17T16:43:24.54233-05:00","closed_at":"2025-12-17T16:43:24.54233-05:00"}
{"id":"homeassistant_adguard_home-bjp","title":"HACS and repository setup","description":"Create hacs.json, README.md with installation/usage docs, LICENSE file. Prepare for HACS default repository submission","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T15:53:23.778905-05:00","updated_at":"2025-12-17T16:00:31.908492-05:00","closed_at":"2025-12-17T16:00:31.908492-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-bjp","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.131375-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-bws","title":"Per-client filtering entities","description":"Create entities for per-client control: enable/disable filtering per device, per-client parental controls, per-client blocked services","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:51.282419-05:00","updated_at":"2025-12-17T16:06:24.206008-05:00","closed_at":"2025-12-17T16:06:24.206008-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-bws","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.868684-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-bws","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.478959-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-bwx","title":"Implement OptionsFlow for configurable scan interval","description":"## Problem\nUsers cannot modify the scan interval (polling frequency) after initial setup. The \\`DEFAULT_SCAN_INTERVAL\\` of 30 seconds is hardcoded. Some users may want faster updates, others may want to reduce API calls.\n\n## Research\n- HACS integrations commonly provide OptionsFlow for polling configuration\n- Home Assistant DataUpdateCoordinator supports dynamic update intervals\n- The official AdGuard Home core integration also lacks this, but it's a good enhancement opportunity\n\n## Location\n- File: \\`custom_components/adguard_home_extended/config_flow.py\\` (add OptionsFlowHandler)\n- File: \\`custom_components/adguard_home_extended/coordinator.py\\` (read from entry.options)\n- File: \\`custom_components/adguard_home_extended/const.py\\` (add config key)\n\n## Implementation\n1. Add \\`OptionsFlowHandler\\` class to config_flow.py\n2. Register options flow in \\`AdGuardHomeConfigFlow\\`\n3. Update coordinator to read interval from \\`entry.options.get(CONF_SCAN_INTERVAL, DEFAULT_SCAN_INTERVAL)\\`\n4. Add listener for options updates to apply changes without restart","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T16:35:42.183542-05:00","updated_at":"2025-12-17T16:58:44.244358-05:00","closed_at":"2025-12-17T16:58:44.244358-05:00"}
{"id":"homeassistant_adguard_home-cbd","title":"Add per-client upstream cache configuration support","description":"## Background\nNewer AdGuard Home versions support per-client custom upstream DNS cache configuration.\n\n## API Fields\nFrom \\`GET /control/clients\\` response, each client can have:\n\\`\\`\\`json\n{\n  \"name\": \"Client Name\",\n  \"upstreams_cache_enabled\": true,\n  \"upstreams_cache_size\": 4096,\n  ../..\n}\n\\`\\`\\`\n\n## Current State\nThe \\`AdGuardHomeClient\\` model doesn't include these fields. Client entities don't expose cache configuration.\n\n## Required Changes\n1. Add to \\`AdGuardHomeClient\\` model:\n\\`\\`\\`python\nupstreams_cache_enabled: bool = True\nupstreams_cache_size: int = 0\n\\`\\`\\`\n\n2. Include in client data fetching in coordinator\n3. Optionally add sensor/switch for per-client cache control\n\n## Research Source\nAdGuard Home CHANGELOG: 'Added new properties clients.persistent.*.upstreams_cache_enabled and clients.persistent.*.upstreams_cache_size that describe cache configuration for each client's custom upstream configuration'","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-17T18:17:33.375563-05:00","updated_at":"2025-12-17T18:17:33.375563-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-cbd","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:18:02.001163-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-cbd","depends_on_id":"homeassistant_adguard_home-nux","type":"blocks","created_at":"2025-12-17T18:18:06.571384-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-csl","title":"Synchronize HA version requirements between pyproject.toml and hacs.json","description":"## Problem\nThere's a mismatch between Home Assistant version requirements:\n\n**pyproject.toml:**\n\\`\\`\\`toml\ndependencies = [\n    \"homeassistant\u003e=2024.1.0\",\n    ../..\n]\n\\`\\`\\`\n\n**hacs.json:**\n\\`\\`\\`json\n{\n  \"homeassistant\": \"2025.1.0\",\n  ../..\n}\n\\`\\`\\`\n\n## Impact\n- pyproject.toml says HA 2024.1.0+ is supported\n- hacs.json says HA 2025.1.0+ is required\n- This creates confusion and may cause HACS to block installation on valid HA versions\n\n## Required Fix\nSynchronize both files to the same minimum version. Recommendation:\n- If targeting latest features: both should be \\`2024.12.0\\` or \\`2025.1.0\\`\n- If targeting wider compatibility: both should be \\`2024.1.0\\`\n\n## Research Source\nHACS documentation states that \\`homeassistant\\` field in hacs.json is the minimum version required for the integration to work","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T18:16:57.798437-05:00","updated_at":"2025-12-17T18:23:22.414455-05:00","closed_at":"2025-12-17T18:23:22.414455-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-csl","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:17:57.286499-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-d5w","title":"Add manifest.json quality_scale and loggers fields","description":"## Background\nHACS and Home Assistant best practices recommend additional manifest.json fields for better integration quality scoring and debugging.\n\n## Current manifest.json\n\\`\\`\\`json\n{\n  \"domain\": \"adguard_home_extended\",\n  \"name\": \"AdGuard Home Extended\",\n  \"codeowners\": [\"@carpenike\"],\n  \"config_flow\": true,\n  \"dependencies\": [],\n  \"documentation\": \"https://github.com/carpenike/homeassistant_adguard_home\",\n  \"iot_class\": \"local_polling\",\n  \"issue_tracker\": \"https://github.com/carpenike/homeassistant_adguard_home/issues\",\n  \"requirements\": [],\n  \"version\": \"0.1.0\",\n  \"integration_type\": \"hub\"\n}\n\\`\\`\\`\n\n## Required Changes\nAdd these fields:\n\\`\\`\\`json\n{\n  \"quality_scale\": \"silver\",\n  \"loggers\": [\"custom_components.adguard_home_extended\"]\n}\n\\`\\`\\`\n\n## Rationale\n- \\`quality_scale\\`: Indicates integration meets silver-tier quality standards\n- \\`loggers\\`: Enables proper log filtering in HA settings\n\n## Research Source\nHome Assistant Developer Docs - Manifest requirements for quality integrations","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T18:16:17.143899-05:00","updated_at":"2025-12-17T18:24:24.997417-05:00","closed_at":"2025-12-17T18:24:24.997417-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-d5w","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:17:52.305736-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-d5w","depends_on_id":"homeassistant_adguard_home-csl","type":"blocks","created_at":"2025-12-17T18:18:10.655008-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-dcm","title":"Add EntityCategory.DIAGNOSTIC to diagnostic sensors","description":"## Problem\nSensors that provide statistics or debugging information (dns_rewrites_count, dhcp_leases_count, dhcp_static_leases_count, recent_queries, avg_processing_time) are not marked with \\`EntityCategory.DIAGNOSTIC\\`, causing them to appear in the main entity list rather than being organized under diagnostics.\n\n## Location\n- File: \\`sensor.py\\` - multiple sensor descriptions\n\n## Affected Sensors\n- \\`dns_rewrites_count\\` (line ~117) - already has it ✓\n- \\`dhcp_leases_count\\` (line ~130) - already has it ✓\n- \\`dhcp_static_leases_count\\` - needs verification\n- \\`avg_processing_time\\` (line ~63) - already has it ✓\n- \\`recent_queries\\` - needs verification\n\n## Recommended Fix\nFor any sensor without the category, add:\n\\`\\`\\`python\nentity_category=EntityCategory.DIAGNOSTIC,\n\\`\\`\\`\n\n## Rationale\nHome Assistant's \\`EntityCategory.DIAGNOSTIC\\` helps organize entities in the UI. Diagnostic entities are hidden from the default entity list and grouped separately in device pages, improving UX by reducing clutter and clearly indicating which entities are informational vs. actionable.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T17:09:28.012233-05:00","updated_at":"2025-12-17T17:15:53.131142-05:00","closed_at":"2025-12-17T17:15:53.131142-05:00"}
{"id":"homeassistant_adguard_home-emr","title":"DHCP sensors","description":"Create sensors for DHCP data: active leases count, static leases, lease details as attributes","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T15:53:09.04395-05:00","updated_at":"2025-12-17T16:26:16.852387-05:00","closed_at":"2025-12-17T16:26:16.852387-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-emr","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.020783-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-emr","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.632668-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-ft3","title":"Make query log limit configurable via options flow","description":"## Problem\nThe coordinator always fetches 100 query log entries, which may be insufficient for power users or excessive for others, potentially impacting performance.\n\n## Location\n- File: \\`coordinator.py\\` line 129\n\n## Current Code\n\\`\\`\\`python\ndata.query_log = await self.client.get_query_log(limit=100)\n\\`\\`\\`\n\n## Recommended Enhancement\n1. Add \\`query_log_limit\\` option to \\`AdGuardHomeOptionsFlow\\` in config_flow.py\n2. Store in entry.options with default of 100\n3. Read from options in coordinator:\n\\`\\`\\`python\nquery_limit = entry.options.get(CONF_QUERY_LOG_LIMIT, DEFAULT_QUERY_LOG_LIMIT)\ndata.query_log = await self.client.get_query_log(limit=query_limit)\n\\`\\`\\`\n\n## Rationale\nUsers with high query volumes may want more history, while users concerned about performance/memory may want fewer entries. Making this configurable follows the pattern already established with scan_interval in the options flow.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T17:08:50.788432-05:00","updated_at":"2025-12-17T18:05:50.447187-05:00","closed_at":"2025-12-17T18:05:50.447187-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-ft3","depends_on_id":"homeassistant_adguard_home-grl","type":"blocks","created_at":"2025-12-17T17:09:48.927131-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-grl","title":"Pass config_entry parameter to DataUpdateCoordinator","description":"## Problem\nThe DataUpdateCoordinator manually sets \\`self.config_entry = entry\\` but doesn't pass it to the parent \\`super().__init__()\\`. Modern Home Assistant (2023.8+) expects the \\`config_entry\\` parameter in the coordinator init.\n\n## Location\n- File: \\`coordinator.py\\` lines 55-68\n\n## Current Code\n\\`\\`\\`python\nsuper().__init__(\n    hass,\n    _LOGGER,\n    name=DOMAIN,\n    update_interval=timedelta(seconds=scan_interval),\n)\nself.client = client\nself.config_entry = entry\n\\`\\`\\`\n\n## Recommended Fix\n\\`\\`\\`python\nsuper().__init__(\n    hass,\n    _LOGGER,\n    name=DOMAIN,\n    update_interval=timedelta(seconds=scan_interval),\n    config_entry=entry,  # Pass to parent\n)\nself.client = client\n# self.config_entry is now set by parent\n\\`\\`\\`\n\n## Rationale\nThe DataUpdateCoordinator base class handles config_entry lifecycle events when passed as a parameter. This enables features like automatic reload on config changes and proper logging context. The current approach works but may miss future HA framework improvements.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T17:08:33.234459-05:00","updated_at":"2025-12-17T17:14:11.780389-05:00","closed_at":"2025-12-17T17:14:11.780389-05:00"}
{"id":"homeassistant_adguard_home-ha1","title":"Sync translations/en.json with strings.json","description":"## Problem\nHome Assistant uses both \\`strings.json\\` and \\`translations/en.json\\` for localization. These files should be identical for the English locale, but they may have drifted apart.\n\n## Research\n- \\`strings.json\\` is the source of truth for config flow strings\n- \\`translations/en.json\\` is loaded by Home Assistant for runtime translations\n- Best practice: keep them synchronized or use a build process\n\n## Location\n- File: \\`custom_components/adguard_home_extended/strings.json\\`\n- File: \\`custom_components/adguard_home_extended/translations/en.json\\`\n\n## Fix Required\n1. Compare both files\n2. Ensure \\`translations/en.json\\` contains all keys from \\`strings.json\\`\n3. Consider adding a CI check to verify synchronization","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T16:36:36.501172-05:00","updated_at":"2025-12-17T16:51:36.051228-05:00","closed_at":"2025-12-17T16:51:36.051228-05:00"}
{"id":"homeassistant_adguard_home-iyj","title":"Translations and strings","description":"Create strings.json and translations/en.json for all entities, services, config flow steps, and error messages","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T15:53:13.732271-05:00","updated_at":"2025-12-17T16:00:31.872535-05:00","closed_at":"2025-12-17T16:00:31.872535-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-iyj","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:39.056145-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-izj","title":"DNS rewrite management","description":"Create services and entities for DNS rewrite rules management: list rewrites, add rewrite, remove rewrite","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T15:53:00.440617-05:00","updated_at":"2025-12-17T16:26:16.42144-05:00","closed_at":"2025-12-17T16:26:16.42144-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-izj","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.944807-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-izj","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.558682-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-jc0","title":"Fix empty API response handling for chunked transfers","description":"## Problem\nThe API client checks \\`response.content_length == 0\\` to detect empty responses, but \\`content_length\\` can be \\`None\\` for chunked transfer encoding responses. This could cause unexpected \\`ContentTypeError\\` when calling \\`.json()\\` on an empty response.\n\n## Location\n- File: \\`api/client.py\\` lines 112-115\n\n## Current Code\n\\`\\`\\`python\n# Some endpoints return empty body on success\nif response.content_length == 0:\n    return None\n\nreturn await response.json()\n\\`\\`\\`\n\n## Recommended Fix\n\\`\\`\\`python\n# Handle empty body gracefully\nif response.status == 204:  # No Content\n    return None\ntry:\n    return await response.json()\nexcept aiohttp.ContentTypeError:\n    return None  # Empty or non-JSON response\n\\`\\`\\`\n\n## Rationale\nHTTP chunked transfer encoding doesn't include a Content-Length header, so \\`content_length\\` will be \\`None\\`. The comparison \\`None == 0\\` is \\`False\\`, causing the code to attempt JSON parsing on potentially empty responses. Using status code 204 and exception handling is more robust.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T17:08:24.429002-05:00","updated_at":"2025-12-17T17:52:40.222141-05:00","closed_at":"2025-12-17T17:52:40.222141-05:00"}
{"id":"homeassistant_adguard_home-ko8","title":"Add protection pause duration support","description":"## Background\nAdGuard Home supports temporarily pausing protection with a duration parameter via \\`POST /control/protection\\`.\n\n## Current Implementation (client.py:152-154)\n\\`\\`\\`python\nasync def set_protection(self, enabled: bool) -\u003e None:\n    \"\"\"Enable or disable protection.\"\"\"\n    await self._post(API_PROTECTION, {\"enabled\": enabled})\n\\`\\`\\`\n\n## AdGuard Home API\n\\`\\`\\`json\nPOST /control/protection\n{\n  \"enabled\": false,\n  \"duration\": 3600000  // milliseconds - protection resumes after this time\n}\n\\`\\`\\`\n\n## Required Changes\n1. Update client method:\n\\`\\`\\`python\nasync def set_protection(self, enabled: bool, duration_ms: int | None = None) -\u003e None:\n    \"\"\"Enable or disable protection.\n    \n    Args:\n        enabled: Whether protection should be enabled\n        duration_ms: If disabling, auto-resume after this many milliseconds\n    \"\"\"\n    data = {\"enabled\": enabled}\n    if not enabled and duration_ms:\n        data[\"duration\"] = duration_ms\n    await self._post(API_PROTECTION, data)\n\\`\\`\\`\n\n2. Add service \\`pause_protection\\` with duration parameter\n3. Optionally add sensor showing time until protection resumes\n\n## Use Case\nUsers can temporarily disable protection for a set time (e.g., \"pause for 1 hour\") without forgetting to re-enable it.\n\n## Research Source\nAdGuard Home API docs: 'The new HTTP API POST /control/protection, that updates protection state and adds an optional pause duration'","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T18:17:16.169052-05:00","updated_at":"2025-12-17T18:31:20.459126-05:00","closed_at":"2025-12-17T18:31:20.459126-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-ko8","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:18:01.920115-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-ls5","title":"Verify and fix hacs.json icon path","description":"## Problem\nThe hacs.json references an icon at \\`custom_components/adguard_home_extended/icon.png\\` but HACS typically expects different path formats depending on version.\n\n## Location\n- File: \\`hacs.json\\` line 7\n\n## Current Code\n\\`\\`\\`json\n{\n  \"icon\": \"custom_components/adguard_home_extended/icon.png\"\n}\n\\`\\`\\`\n\n## Required Verification\n1. Verify icon.png exists at the specified path (confirmed: 469KB file exists)\n2. Check if HACS expects repo-root relative path or different format\n3. Test icon display in HACS UI\n\n## Potential Fixes\n- May need to use relative path from repo root without \\`custom_components/\\` prefix\n- Or reference a URL to a hosted icon\n- Or register with home-assistant/brands repository for official icons\n\n## Rationale\nHACS documentation indicates icon handling varies. If the path is wrong, users won't see the integration icon in the HACS UI, making the integration harder to identify.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T17:08:42.048852-05:00","updated_at":"2025-12-17T17:14:38.591769-05:00","closed_at":"2025-12-17T17:14:38.591769-05:00"}
{"id":"homeassistant_adguard_home-m2g","title":"Config flow implementation","description":"Create config_flow.py with UI wizard for host, port, username, password, SSL verification. Include connection validation and reauthentication support","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-17T15:52:28.984226-05:00","updated_at":"2025-12-17T16:00:21.367977-05:00","closed_at":"2025-12-17T16:00:21.367977-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-m2g","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.676203-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-m2g","depends_on_id":"homeassistant_adguard_home-1bb","type":"blocks","created_at":"2025-12-17T15:53:47.278271-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-n68","title":"Add __all__ exports to api/__init__.py","description":"## Problem\nThe \\`api/__init__.py\\` module doesn't define \\`__all__\\` to explicitly export the client classes, making imports less clean and IDE auto-imports less reliable.\n\n## Location\n- File: \\`api/__init__.py\\`\n\n## Current State\nThe file exists but may be empty or not export the key classes.\n\n## Recommended Fix\n\\`\\`\\`python\n\"\"\"AdGuard Home API client.\"\"\"\nfrom .client import (\n    AdGuardHomeClient,\n    AdGuardHomeError,\n    AdGuardHomeAuthError,\n    AdGuardHomeConnectionError,\n)\nfrom .models import (\n    AdGuardHomeStatus,\n    AdGuardHomeStats,\n    FilteringStatus,\n    AdGuardHomeClient as ClientConfig,\n    BlockedService,\n    DhcpStatus,\n    DnsRewrite,\n)\n\n__all__ = [\n    \"AdGuardHomeClient\",\n    \"AdGuardHomeError\",\n    \"AdGuardHomeAuthError\",\n    \"AdGuardHomeConnectionError\",\n    \"AdGuardHomeStatus\",\n    \"AdGuardHomeStats\",\n    \"FilteringStatus\",\n    \"ClientConfig\",\n    \"BlockedService\",\n    \"DhcpStatus\",\n    \"DnsRewrite\",\n]\n\\`\\`\\`\n\n## Rationale\nDefining \\`__all__\\` is a Python best practice for packages. It enables cleaner imports (\\`from .api import AdGuardHomeClient\\`), improves IDE support, and documents the public API explicitly.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T17:09:08.852227-05:00","updated_at":"2025-12-17T17:15:11.900451-05:00","closed_at":"2025-12-17T17:15:11.900451-05:00"}
{"id":"homeassistant_adguard_home-ncl","title":"Update blocked_services API payload format for v0.107.37+","description":"## Problem\nThe \\`set_blocked_services\\` method sends a plain list to the API:\n\\`\\`\\`python\nawait self._post(API_BLOCKED_SERVICES_SET, services)\n\\`\\`\\`\n\nHowever, AdGuard Home v0.107.37+ changed the API to expect a different format with schedule support.\n\n## Research\nPer AdGuard Home changelog and API updates:\n- Old format (pre-0.107.37): \\`['service1', 'service2']\\`\n- New format (0.107.37+): \\`{'ids': ['service1', 'service2'], 'schedule': {...}}\\`\n- The old format may still work but could break in future versions\n\n## Location\n- File: \\`custom_components/adguard_home_extended/api/client.py\\` line 265\n\n## Fix Required\nUpdate to use the new format:\n\\`\\`\\`python\nasync def set_blocked_services(self, services: list[str]) -\u003e None:\n    await self._post(API_BLOCKED_SERVICES_SET, {\n        'ids': services,\n        'schedule': {'time_zone': 'Local'}  # or appropriate default\n    })\n\\`\\`\\`\n\nConsider also checking AdGuard Home version and using appropriate format.","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-17T16:36:10.312576-05:00","updated_at":"2025-12-17T16:49:26.504238-05:00","closed_at":"2025-12-17T16:49:26.504238-05:00"}
{"id":"homeassistant_adguard_home-nux","title":"Add client UID field to AdGuardHomeClient model","description":"## Background\nSince AdGuard Home v0.107.46, persistent clients have a \\`uid\\` field that provides a stable unique identifier separate from the client name.\n\n## Current Model (models.py:99-128)\n\\`\\`\\`python\n@dataclass\nclass AdGuardHomeClient:\n    name: str\n    ids: list[str] = field(default_factory=list)\n    use_global_settings: bool = True\n    # ../.. other fields\n\\`\\`\\`\n\n## Missing Field\n\\`\\`\\`python\nuid: str = \"\"  # Unique identifier (v0.107.46+)\n\\`\\`\\`\n\n## Why It Matters\n- \\`name\\` can be changed by users\n- \\`uid\\` is immutable and guaranteed unique\n- Using \\`uid\\` for entity unique_id would survive client renames\n\n## Required Changes\n1. Add \\`uid\\` field to \\`AdGuardHomeClient\\` dataclass\n2. Update \\`from_dict()\\` to extract uid\n3. Consider using uid (when available) for entity identification\n\n## Research Source\nAdGuard Home CHANGELOG v0.107.46: 'The new property clients.persistent.*.uid, which is a unique identifier of the persistent client'","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T18:17:25.305189-05:00","updated_at":"2025-12-17T18:30:29.672364-05:00","closed_at":"2025-12-17T18:30:29.672364-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-nux","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:18:01.962882-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-ota","title":"Query log sensors","description":"Create sensors for query log data: recent queries, recent blocked queries, query log statistics","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-17T15:53:04.547317-05:00","updated_at":"2025-12-17T16:26:16.661712-05:00","closed_at":"2025-12-17T16:26:16.661712-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-ota","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.980854-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-ota","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.596117-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-ply","title":"Blocked services switches","description":"Create switches to toggle blocking of specific services: social media (TikTok, Instagram, etc.), streaming (Netflix, YouTube), AI services (ChatGPT, Claude)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:46.739378-05:00","updated_at":"2025-12-17T16:02:25.526722-05:00","closed_at":"2025-12-17T16:02:25.526722-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-ply","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.829094-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-ply","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.437339-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-t4k","title":"Add DNS rewrite update API endpoint","description":"## Background\nAdGuard Home v0.107.36 added \\`PUT /control/rewrite/update\\` for editing existing DNS rewrites in place, instead of requiring delete + re-add.\n\n## Current State\nThe integration only supports:\n- \\`add_rewrite(domain, answer)\\` via \\`POST /control/rewrite/add\\`\n- \\`delete_rewrite(domain, answer)\\` via \\`POST /control/rewrite/delete\\`\n\nMissing the update capability.\n\n## Required Changes\n1. Add constant to \\`const.py\\`:\n\\`\\`\\`python\nAPI_REWRITE_UPDATE: Final = \"/control/rewrite/update\"\n\\`\\`\\`\n\n2. Add client method:\n\\`\\`\\`python\nasync def update_rewrite(\n    self, \n    old_domain: str, \n    old_answer: str,\n    new_domain: str,\n    new_answer: str\n) -\u003e None:\n    \"\"\"Update an existing DNS rewrite.\"\"\"\n    await self._put(API_REWRITE_UPDATE, {\n        \"target\": {\"domain\": old_domain, \"answer\": old_answer},\n        \"update\": {\"domain\": new_domain, \"answer\": new_answer}\n    })\n\\`\\`\\`\n\n3. Add \\`update_dns_rewrite\\` service\n\n## Research Source\nAdGuard Home CHANGELOG: 'The ability to edit rewrite rules via PUT /control/rewrite/update HTTP API and the Web UI (#1577)'","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T18:16:37.721131-05:00","updated_at":"2025-12-17T18:29:37.067561-05:00","closed_at":"2025-12-17T18:29:37.067561-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-t4k","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:17:57.210115-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-tue","title":"Add async_migrate_entry for future config version changes","description":"## Problem\nThe config flow has \\`VERSION = 1\\` but no \\`async_migrate_entry\\` function is defined. When the config schema changes in the future, there will be no migration path for existing users.\n\n## Location\n- File: \\`config_flow.py\\` line 50\n\n## Current Code\n\\`\\`\\`python\nclass AdGuardHomeConfigFlow(ConfigFlow, domain=DOMAIN):\n    VERSION = 1\n    # No async_migrate_entry defined\n\\`\\`\\`\n\n## Recommended Enhancement\nAdd a placeholder migration function in \\`__init__.py\\`:\n\\`\\`\\`python\nasync def async_migrate_entry(hass: HomeAssistant, config_entry: ConfigEntry) -\u003e bool:\n    \"\"\"Migrate old entry.\"\"\"\n    _LOGGER.debug(\"Migrating from version %s\", config_entry.version)\n\n    if config_entry.version == 1:\n        # Future: migrate v1 -\u003e v2\n        pass\n\n    return True\n\\`\\`\\`\n\n## Rationale\nHome Assistant calls \\`async_migrate_entry\\` when loading a config entry with a version lower than the current \\`VERSION\\`. Having the scaffolding in place makes future migrations easier and prevents the integration from failing to load when schema changes are introduced.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T17:09:18.009814-05:00","updated_at":"2025-12-17T18:12:04.659286-05:00","closed_at":"2025-12-17T18:12:04.659286-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-tue","depends_on_id":"homeassistant_adguard_home-8uk","type":"blocks","created_at":"2025-12-17T17:09:39.179586-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-vjo","title":"Fix device_info return type to use DeviceInfo dataclass","description":"## Problem\nIn \\`coordinator.py\\`, the \\`device_info\\` property returns a plain dict, but Home Assistant best practice (and type hints) expect \\`DeviceInfo\\` from \\`homeassistant.helpers.device_registry\\`.\n\n## Current Code (coordinator.py:152-165)\n\\`\\`\\`python\n@property\ndef device_info(self) -\u003e dict[str, Any]:\n    return {\n        \"identifiers\": {(DOMAIN, self.config_entry.entry_id)},\n        \"name\": f\"AdGuard Home ({self.config_entry.data.get('host', 'unknown')})\",\n        ../..\n    }\n\\`\\`\\`\n\n## Required Fix\n\\`\\`\\`python\nfrom homeassistant.helpers.device_registry import DeviceInfo\n\n@property\ndef device_info(self) -\u003e DeviceInfo:\n    return DeviceInfo(\n        identifiers={(DOMAIN, self.config_entry.entry_id)},\n        name=f\"AdGuard Home ({self.config_entry.data.get('host', 'unknown')})\",\n        manufacturer=\"AdGuard\",\n        model=\"AdGuard Home\",\n        sw_version=version,\n    )\n\\`\\`\\`\n\n## Research Source\nHome Assistant Developer Docs - DeviceInfo is the proper type for device registry integration. Using the dataclass ensures proper validation and future compatibility.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-17T18:15:49.158178-05:00","updated_at":"2025-12-17T18:21:48.42478-05:00","closed_at":"2025-12-17T18:21:48.42478-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-vjo","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:17:47.655245-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-vrs","title":"Add MINOR_VERSION to config flow for migration tracking","description":"## Background\nHome Assistant config entries support both \\`VERSION\\` and \\`MINOR_VERSION\\` for schema migrations.\n\n## Current Code (config_flow.py:54)\n\\`\\`\\`python\nclass AdGuardHomeConfigFlow(ConfigFlow, domain=DOMAIN):\n    VERSION = 1\n\\`\\`\\`\n\n## Recommended Change\n\\`\\`\\`python\nclass AdGuardHomeConfigFlow(ConfigFlow, domain=DOMAIN):\n    VERSION = 1\n    MINOR_VERSION = 1\n\\`\\`\\`\n\n## Rationale\n- \\`VERSION\\` changes require migration code in \\`async_migrate_entry()\\`\n- \\`MINOR_VERSION\\` allows tracking smaller schema changes without full migration\n- Provides better upgrade path documentation for users\n\n## Research Source\nHome Assistant Developer Docs - Config Flow: 'The schema version of the entries that it creates. Home Assistant will call your migrate method if the version changes'","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-17T18:17:06.418519-05:00","updated_at":"2025-12-17T18:24:05.436809-05:00","closed_at":"2025-12-17T18:24:05.436809-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-vrs","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:17:57.327856-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-xdm","title":"Fix multi-instance service registration","description":"## Problem\nServices are registered globally with \\`if not hass.services.has_service(...)\\` guard, but the service handlers capture the \\`coordinator\\` from whichever config entry is set up first. With multiple AdGuard Home instances, ALL service calls go to the first instance regardless of user intent.\n\n## Research\n- Home Assistant best practice: services should either use entity targets or look up the correct coordinator\n- The current pattern breaks for any user with 2+ AdGuard Home servers\n- Official integrations use device/entity targeting for multi-instance support\n\n## Location\n- File: \\`custom_components/adguard_home_extended/__init__.py\\` lines 85 and 161-244\n\n## Fix Required\nOption A (Recommended): Refactor services to accept a \\`device_id\\` or \\`entry_id\\` parameter and look up the correct coordinator:\n\\`\\`\\`python\nasync def handle_set_blocked_services(call: ServiceCall) -\u003e None:\n    # Look up coordinator from hass.data based on target\n    entry_id = call.data.get('entry_id')\n    if entry_id and entry_id in hass.data[DOMAIN]:\n        coordinator = hass.data[DOMAIN][entry_id]\n    elif len(hass.data[DOMAIN]) == 1:\n        coordinator = next(iter(hass.data[DOMAIN].values()))\n    else:\n        raise ServiceValidationError('Must specify entry_id with multiple instances')\n    # ../.. rest of handler\n\\`\\`\\`\n\nOption B: Convert to entity services that automatically target the correct device.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-17T16:35:10.221737-05:00","updated_at":"2025-12-17T16:46:54.335977-05:00","closed_at":"2025-12-17T16:46:54.335977-05:00"}
{"id":"homeassistant_adguard_home-yge","title":"Add DNS configuration API endpoints for cache control","description":"## Background\nAdGuard Home v0.107.65+ added explicit DNS cache control via new API fields:\n- \\`GET /control/dns_info\\` - includes new \\`cache_enabled\\` boolean field\n- \\`POST /control/dns_config\\` - accepts \\`cache_enabled\\` to toggle cache without losing size config\n\n## Current State\nThe integration only has \\`API_FILTERING_CONFIG = /control/filtering/config\\` which is for filtering settings, not DNS configuration.\n\n## Required Changes\n1. Add constants to \\`const.py\\`:\n\\`\\`\\`python\nAPI_DNS_INFO: Final = \"/control/dns_info\"\nAPI_DNS_CONFIG: Final = \"/control/dns_config\"\n\\`\\`\\`\n\n2. Add client methods:\n\\`\\`\\`python\nasync def get_dns_info(self) -\u003e dict:\n    return await self._get(API_DNS_INFO)\n\nasync def set_dns_config(self, config: dict) -\u003e None:\n    await self._post(API_DNS_CONFIG, config)\n\\`\\`\\`\n\n3. Optionally add a switch for DNS cache enable/disable\n\n## Research Source\nAdGuard Home CHANGELOG v0.107.65: 'A new cache_enabled field to the HTTP API (GET /control/dns_info and POST /control/dns_config)'","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-17T18:16:07.553447-05:00","updated_at":"2025-12-17T18:27:12.258474-05:00","closed_at":"2025-12-17T18:27:12.258474-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-yge","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:17:52.265555-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-yns","title":"Switch entities - protection toggles","description":"Create switch.py with switches for: global protection, safe browsing, parental control, safe search enforcement","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-17T15:52:42.110974-05:00","updated_at":"2025-12-17T16:00:31.833492-05:00","closed_at":"2025-12-17T16:00:31.833492-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-yns","depends_on_id":"homeassistant_adguard_home-0d8","type":"parent-child","created_at":"2025-12-17T15:53:38.791167-05:00","created_by":"daemon"},{"issue_id":"homeassistant_adguard_home-yns","depends_on_id":"homeassistant_adguard_home-5k9","type":"blocks","created_at":"2025-12-17T15:53:47.392432-05:00","created_by":"daemon"}]}
{"id":"homeassistant_adguard_home-zfs","title":"Expand DhcpStatus model with missing API fields","description":"## Background\nThe current \\`DhcpStatus\\` model in \\`models.py:177-195\\` is missing several fields that the AdGuard Home API returns.\n\n## Current Model\n\\`\\`\\`python\n@dataclass\nclass DhcpStatus:\n    enabled: bool = False\n    interface_name: str = \"\"\n    leases: list[DhcpLease] = field(default_factory=list)\n    static_leases: list[DhcpLease] = field(default_factory=list)\n\\`\\`\\`\n\n## Missing Fields\nFrom the AdGuard Home API \\`GET /control/dhcp/status\\`:\n- \\`v4\\` - IPv4 DHCP configuration object:\n  - \\`gateway_ip\\`\n  - \\`subnet_mask\\`\n  - \\`range_start\\`\n  - \\`range_end\\`\n  - \\`lease_duration\\`\n- \\`v6\\` - IPv6 DHCP configuration object:\n  - \\`range_start\\`\n  - \\`lease_duration\\`\n\n## Required Changes\n1. Create \\`DhcpV4Config\\` and \\`DhcpV6Config\\` dataclasses\n2. Add these to \\`DhcpStatus\\`:\n\\`\\`\\`python\n@dataclass\nclass DhcpStatus:\n    enabled: bool = False\n    interface_name: str = \"\"\n    v4: DhcpV4Config | None = None\n    v6: DhcpV6Config | None = None\n    leases: list[DhcpLease] = field(default_factory=list)\n    static_leases: list[DhcpLease] = field(default_factory=list)\n\\`\\`\\`\n\n3. Optionally expose DHCP configuration as sensors\n\n## Research Source\nAdGuard Home OpenAPI spec - dhcp/status endpoint returns full v4/v6 configuration","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-17T18:16:47.029551-05:00","updated_at":"2025-12-17T18:28:12.717239-05:00","closed_at":"2025-12-17T18:28:12.717239-05:00","dependencies":[{"issue_id":"homeassistant_adguard_home-zfs","depends_on_id":"homeassistant_adguard_home-53z","type":"blocks","created_at":"2025-12-17T18:17:57.24773-05:00","created_by":"daemon"}]}
